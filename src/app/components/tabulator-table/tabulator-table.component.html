<div class="space-y-4">
    <!-- TOAST NOTIFICATIONS -->
    <p-toast position="top-right"></p-toast>

    <!-- Top Toolbar - Only show selection info, not expand button -->
    <div class="flex flex-wrap items-center justify-between gap-3" *ngIf="selectedRows.length > 0 || config.editable">
        <!-- Left Side - Selection Info -->
        <div class="flex flex-wrap items-center gap-3">
            <!-- Selection Info -->
            <div *ngIf="selectedRows.length > 0" class="flex items-center gap-2 px-4 py-2 bg-blue-50 border border-blue-200 rounded-full">
                <i class="pi pi-check-circle text-blue-600"></i>
                <span class="text-sm font-medium text-blue-700">{{ selectedRows.length }} row(s) selected</span>
                <button 
                    pButton 
                    icon="pi pi-times" 
                    class="p-button-text p-button-sm !text-blue-600 hover:!text-blue-800"
                    (click)="clearSelection()"
                    pTooltip="Clear selection"
                ></button>
            </div>
        </div>

        <!-- Right Side Actions -->
        <div class="flex flex-wrap items-center gap-3">
            <!-- Export Dropdown -->
            <button 
                pButton 
                [icon]="selectedRows.length > 0 ? 'pi pi-download' : 'pi pi-download'"
                [label]="getExportLabel()"
                class="!rounded-full !px-5 !py-2.5 !bg-gray-50 !text-gray-700 !border !border-gray-300 hover:!bg-gray-100"
                (click)="exportToCSV()"
            ></button>

            <!-- Excel Export -->
            <button 
                *ngIf="selectedRows.length > 0"
                pButton 
                icon="pi pi-file-excel"
                label="Export to Excel"
                class="!rounded-full !px-5 !py-2.5 !bg-green-50 !text-green-700 !border !border-green-300 hover:!bg-green-100"
                (click)="exportToExcel()"
            ></button>

            <!-- Clear Data (if editable) -->
            <button 
                *ngIf="config.editable"
                pButton 
                icon="pi pi-trash"
                label="Clear All"
                class="!rounded-full !px-5 !py-2.5 !bg-red-50 !text-red-700 !border !border-red-300 hover:!bg-red-100"
                (click)="clearData()"
            ></button>
        </div>
    </div>

    <!-- TABLE CONTAINER with embedded expand button -->
    <div class="relative">
        <!-- Expand Button - Positioned inside table (top right) -->
        <button 
            *ngIf="showExpandButton"
            pButton 
            [icon]="isExpanded ? 'pi pi-compress' : 'pi pi-window-maximize'"
            class="absolute top-4 right-4 z-10 !rounded-lg !px-3 !py-2 !bg-white !text-gray-700 !border !border-gray-300 hover:!bg-gray-50 shadow-sm"
            (click)="toggleExpand()"
            [pTooltip]="isExpanded ? 'Minimize table' : 'Expand table to full screen'"
            tooltipPosition="left"
        ></button>

        <!-- TABLE CONTAINER - Figma Style -->
        <div id="data-table" #tableContainer class="!rounded-2xl overflow-hidden border border-gray-200" style="min-height: 400px;"></div>
    </div>

    <!-- ================= FLOATING ACTION DIALOG (EDITABLE MODE ONLY) ================= -->
    <div 
        *ngIf="showFloatingActions && config.editable" 
        class="floating-actions-dialog"
        [style.bottom]="floatingActionsPosition.bottom"
        [style.left]="floatingActionsPosition.left"
    >
        <div class="floating-actions-content">
            <!-- Selection Count -->
            <span class="selection-count">{{ selectedRows.length }} Selected</span>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <!-- Custom Operation (First Icon - Not Confirmed) -->
                <button 
                    pButton 
                    icon="pi pi-cog" 
                    class="p-button-text action-btn"
                    (click)="customOperation()"
                    pTooltip="Custom Operation"
                    tooltipPosition="top"
                ></button>

                <!-- Swap Parent/Child -->
                <button 
                    pButton 
                    icon="pi pi-sort-alt" 
                    class="p-button-text action-btn"
                    (click)="swapParentChild()"
                    pTooltip="Swap Parent with Child"
                    tooltipPosition="top"
                ></button>

                <!-- Assign as Parent -->
                <button 
                    pButton 
                    icon="pi pi-arrow-up" 
                    class="p-button-text action-btn"
                    (click)="assignAsParent()"
                    pTooltip="Assign as Parent"
                    tooltipPosition="top"
                ></button>

                <!-- Delete -->
                <button 
                    pButton 
                    icon="pi pi-trash" 
                    class="p-button-text action-btn delete-btn"
                    (click)="deleteSelectedRowsFromFloating()"
                    pTooltip="Delete Selected"
                    tooltipPosition="top"
                ></button>
            </div>
        </div>
    </div>
</div>